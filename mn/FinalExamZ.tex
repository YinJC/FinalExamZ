%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
% finalexamz - Шалгалтын материалын эх бэлтгэхэд ашиглагдах 
% finalexamz - LaTeX системд суурилсан багаж ба загвар
%
% Хувилбар 1.1.0
%
% Хөгжүүлсэн Галаа (www.galaa.mn)
% Copyright (c) 2015 Galaa
% Лиценз LATEX Project Public License (LPPL) (http://www.latex-project.org/lppl.txt)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Энэ хэсгийг өөрчлөх шаардлагагүй
%
\documentclass[10pt,oneside]{article}
\usepackage[utf8]{inputenc}
\usepackage[mongolian]{babel}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Энд зохих мэдээллээ оруулна уу
%
\newcommand{\institution}{СУРГУУЛИЙН НЭР}
\newcommand{\logo}{logo.png} % шаардлагагүй бол хоосон үлдээнэ
\newcommand{\examtype}{Хаврын улирлын шалгалт}
\newcommand{\examdate}{2015}
\newcommand{\coursetitle}{Хичээлийн нэр}
\newcommand{\coursecode}{INDEX555}
\newcommand{\teacher}{Г.Махгал}
\newcommand{\totaltime}{90 минут}
\newcommand{\materials}{Тооны машин; өөрийн ном, лекцийн тэмдэглэл}
\newcommand{\caution}{Өөр бусад анхааруулга, санамж, зөвлөмж зэргийг энд бичиж өгнө.}
\newcommand{\examvariants}{2}
\newcommand{\printsolution}{no} % yes эсвэл no
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Энэ хэсгийг өөрчлөх шаардлагагүй
%
\usepackage{amsmath,amssymb,fmtcount,graphicx,xcolor,fancyhdr,multido,ifthen,background,xstring,tikz}
\usepackage[a4paper,margin=2cm,top=2.5cm,left=3cm,bottom=2.5cm]{geometry}
\usepackage[normalem]{ulem}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Энд нэмж дуудах сангууд болон функцүүдээ оруулна
%
% \usepackage[options]{package}
% \DeclareMathOperator{command}{text}
%

\DeclareMathOperator{\cov}{cov}

%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Үүнээс дооших скриптийг өөрчлөх шаардлагагүй
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\SetBgContents{\textcolor{black}{FinalExamZ\ \copyright\ 2015\ Галаа\ (www.galaa.mn).\ \LaTeX\ ашиглав.}}
\SetBgPosition{17.5cm,-20cm}
\SetBgOpacity{1.0}
\SetBgAngle{90.0}
\SetBgScale{1.0}

\newcounter{variant}

\pagestyle{fancy}
\lhead{} \chead{} \rhead{} 
\lfoot{} \cfoot{\footnotesize{Хуудас $\dfrac{\thepage}{\pageref{finalpage\Alph{variant}}}$ $\ast$ \coursetitle \ (\coursecode) $\ast$ Хувилбар \arabic{variant}}} \rfoot{} 

\renewcommand{\headrulewidth}{0pt} %Do not print a rule below the header
\renewcommand{\footrulewidth}{0pt}

% Нүүр хуудас

\newcommand{\coverpage}{
\ifthenelse{\equal{\logo}{}}{
$\,$
\vspace{1.5cm}
}{
\begin{center}
\includegraphics[height=3cm]{\logo}\\[1cm]
\end{center}
}
\begin{center}
\Large\textbf{\institution}
\end{center}
\vspace{2cm}

\begin{center}
\Large\textit{ \examtype\,\,--\,\,\examdate}
\end{center}
\vspace{2cm}

\begin{center}
\Huge\textbf{\coursetitle}
\end{center}
\begin{center}
\large\textbf{\coursecode}
\end{center}
\begin{center}
\Large\textbf{\teacher}
\end{center}
\vspace{2cm}

\begin{center}
\large
\ifthenelse{\equal{\printsolution}{yes}}{
Бодолт, Хариу, Түлхүүр
}{
$$
\begin{array}{rl}
\text{Оюутны мэдээлэл} & \text{\footnotesize(\textit{бүрэн гүйцэд бөглөнө үү})} \\[0.2cm]
\text{Овог} & $\ldots\ldots\ldots\ldots\ldots\ldots\ldots$ \\[0.2cm]
\text{Нэр} & $\ldots\ldots\ldots\ldots\ldots\ldots\ldots$ \\[0.2cm]
\text{ID} & $\ldots\ldots\ldots\ldots\ldots\ldots\ldots$
\end{array}
$$
}
\end{center}
} % Нүүр хуудас

% Шалгалт материалтын хувилбарууд буюу вариантуудыг хэвлэх

\newcommand{\print}{
 \multido{\n=1+1}{\examvariants}{\PrintVariant{\n}}
}

% Хэвлэх функц

\newcounter{number}
\newcounter{totalpoint}

\newcommand{\PrintVariant}[1]{
  \newpage
  \setcounter{page}{1}
  \setcounter{variant}{#1}
  \setcounter{number}{1}
  \coverpage
  \setcounter{totalpoint}{0}
  \newpage
  \ifthenelse{\equal{\printsolution}{yes}}{}{
   \paragraph{Анхаарамж} \hfill {\small Амжилт хүсье!}
   \begin{itemize}
    \setlength{\itemsep}{0mm}
    \item Шалгалтын нийт хугацаа: \totaltime
    \item Зөвшөөрөгдсөн материал: \materials
    \ifthenelse{\equal{\caution}{}}{}{\item \caution}
   \end{itemize}
   \vspace{-0.5em} \textcolor{black!50}{\hrulefill}
  }
  \input{Variant_#1.tex}
  \paragraph{} \hfill нийт оноо \arabic{totalpoint}
  \begin{center}
    $\ast\ast\ast$ \textit{Шалгалтын материалын төгсгөл} $\ast\ast\ast$
    \label{finalpage\Alph{variant}}
  \end{center}
}

% Бодлого

\newcommand{\problem}[4][1.5]{
 \paragraph{\textnumero\arabic{number}.} \hspace{-1em} {\small\textit{Бодлого}} \addtocounter{number}{1} \hfill {\small\textit{#3 оноо}} \addtocounter{totalpoint}{#3} \\[2mm] 
 #2 
 \vspace{2mm} \par \textit{Бодолт \ldots} 
 \ifthenelse{\equal{\printsolution}{yes}}{#4}{\vspace{#1cm}}
 \vspace{-1em}$$\,$$\textcolor{black!50}{\hrulefill}
}

% Асуулт

\newcommand{\question}[4][0.5]{
 \paragraph{\textnumero\arabic{number}.} \hspace{-1em} {\small\textit{Асуулт}} \addtocounter{number}{1} \hfill {\small\textit{#3 оноо}} \addtocounter{totalpoint}{#3} \\[2mm] 
 #2 
 \vspace{2mm} \par \textit{Хариулт \ldots} 
 \ifthenelse{\equal{\printsolution}{yes}}{#4}{\vspace{#1cm}}
 \vspace{-1em}$$\,$$\textcolor{black!50}{\hrulefill}
}

% Сонгох тест

\newcounter{testchoices}

\newcommand{\stest}[3]{
 \paragraph{\textnumero\arabic{number}.} \hspace{-1em} {\small\textit{Сонгох тест}} \addtocounter{number}{1} \hfill {\small\textit{#2 оноо}} \addtocounter{totalpoint}{#2} \\[2mm] 
 #1 
 \vspace{2mm} \par \textit{\ifthenelse{\equal{\printsolution}{yes}}{Зөв сонголт}{Сонголт} \ldots} \setcounter{testchoices}{1}
 \begin{center}
  \splitlist{#3}
 \end{center}
 \textcolor{black!50}{\hrulefill}
}

\makeatletter
\newcommand{\splitlist}[1]{\@splitlist#1\@nil}
\def\@splitlist#1\@nil{%
  \if\relax\detokenize{#1}\relax
    \expandafter\@gobble
  \else
    \expandafter\@firstofone
  \fi
  {\@spl@tlist#1//\@nil}%
}
\def\@spl@tlist#1//#2\@nil{%
  \ifthenelse{\equal{\printsolution}{yes}}{
    \IfSubStr{#1}{[+]}{\textcircled{\Alph{testchoices}}}{\Alph{testchoices}.}
  }{\Alph{testchoices}.}
  \StrSubstitute[0]{#1}{[+]}{}\qquad \addtocounter{testchoices}{1}
  \if\relax\detokenize{#2}\relax
    \expandafter\@firstoftwo
  \else
    \expandafter\@secondoftwo
  \fi
  {\unskip}%
  {\@spl@tlist#2\@nil}%
}
\makeatother

% Нөхөх тест

\newcommand{\ptest}[2]{
 \paragraph{\textnumero\arabic{number}.} \hspace{-1em} {\small\textit{Нөхөх тест}} \addtocounter{number}{1} \hfill {\small\textit{#2 оноо}} \addtocounter{totalpoint}{#2} \\[2mm] 
 #1 
 \vspace{0.5em}
 \par\noindent
 \textcolor{black!50}{\hrulefill}
}

\newcommand{\ehide}[1]{\ifthenelse{\equal{\printsolution}{yes}}{#1}{\underline{\phantom{#1}}}}

\newcommand{\thide}[1]{\ifthenelse{\equal{\printsolution}{yes}}{#1}{\uline{#1}}}

\makeatletter
\def\UL@putbox{\ifx\UL@start\@empty \else % not inner
  \vrule\@width\z@ \LA@penalty\@M
  {\UL@skip\wd\UL@box \UL@leaders \kern-\UL@skip}%
    \phantom{\box\UL@box}%
  \fi}
\makeatother

\begin{document}

\print

\end{document}
