%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 
% finalexamz - LaTeX Template & Tool for Exam Preparation
%
% Version 1.0.0
%
% Developed by Galaa (www.galaa.mn)
% Copyright (c) 2015 Galaa
% License: LATEX Project Public License (LPPL) (http://www.latex-project.org/lppl.txt)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[10pt,oneside]{article}
\usepackage[utf8]{inputenc}
\usepackage[mongolian]{babel}

\newcommand{\institution}{UNIVERSITY NAME}
\newcommand{\logo}{logo.png} % Leave empty, if you have no logo
\newcommand{\examtype}{Final Exam}
\newcommand{\examdate}{2015}
\newcommand{\coursetitle}{Course Title}
\newcommand{\coursecode}{INDEX555}
\newcommand{\teacher}{Teacher Name}
\newcommand{\totaltime}{2 hours}
\newcommand{\materials}{Permitted materials}
\newcommand{\caution}{Any Caution}
\newcommand{\examvariants}{2} % number of Variants, same as number of files "Variant_#.tex"
\newcommand{\printsolution}{no} % yes or no

\usepackage{amsmath,amssymb,fmtcount,graphicx,xcolor,fancyhdr,multido,ifthen,background,xstring,tikz}
\usepackage[a4paper,margin=2cm,top=2.5cm,left=3cm,bottom=2.5cm]{geometry}
\usepackage[normalem]{ulem}

\DeclareMathOperator{\cov}{cov}

\SetBgContents{\textcolor{black}{\copyright\,2015\,Galaa (www.galaa.mn).\,Powered by \LaTeX.}}
\SetBgPosition{17.5cm,-20cm}
\SetBgOpacity{1.0}
\SetBgAngle{90.0}
\SetBgScale{1.0}

\newcounter{variant}

\pagestyle{fancy}
\lhead{} \chead{} \rhead{} 
\lfoot{} \cfoot{\footnotesize{Page $\dfrac{\thepage}{\pageref{finalpage\Alph{variant}}}$ $\ast$ \coursetitle \ (\coursecode) $\ast$ Variant \arabic{variant}}} \rfoot{} 

\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

% Cover Page

\newcommand{\coverpage}{
\ifthenelse{\equal{\logo}{}}{
$\,$
\vspace{1.5cm}
}{
\begin{center}
\includegraphics[height=3cm]{\logo}\\[1cm]
\end{center}
}
\begin{center}
\Large\textbf{\institution}
\end{center}
\vspace{2cm}

\begin{center}
\Large\textit{ \examtype\,\,--\,\,\examdate}
\end{center}
\vspace{2cm}

\begin{center}
\Huge\textbf{\coursetitle}
\end{center}
\begin{center}
\large\textbf{\coursecode}
\end{center}
\begin{center}
\Large\textbf{\teacher}
\end{center}
\vspace{2cm}

\begin{center}
\large
\ifthenelse{\equal{\printsolution}{yes}}{
Solution
}{
$$
\begin{array}{rl}
\text{Student Information} & \text{\footnotesize(\textit{fill completely})} \\[0.2cm]
\text{First Name} & $\ldots\ldots\ldots\ldots\ldots\ldots\ldots$ \\[0.2cm]
\text{Last Name} & $\ldots\ldots\ldots\ldots\ldots\ldots\ldots$ \\[0.2cm]
\text{Student ID} & $\ldots\ldots\ldots\ldots\ldots\ldots\ldots$
\end{array}
$$
}
\end{center}
} % Cover Page

% Print Variants

\newcommand{\print}{
 \multido{\n=1+1}{\examvariants}{\PrintVariant{\n}}
}

% Function for Print

\newcounter{number}
\newcounter{totalpoint}

\newcommand{\PrintVariant}[1]{
  \newpage
  \setcounter{page}{1}
  \setcounter{variant}{#1}
  \setcounter{number}{1}
  \coverpage
  \setcounter{totalpoint}{0}
  \newpage
  \paragraph{Attention} \hfill {\small Good Luck!}
  \begin{itemize}
   \setlength{\itemsep}{0mm}
   \item Exam Duration: \totaltime
   \item Permitted Materials: \materials
   \ifthenelse{\equal{\caution}{}}{}{\item \caution}
  \end{itemize}
  \vspace{-0.5em} \textcolor{black!50}{\hrulefill}
  \input{Variant_#1.tex}
  \paragraph{} \hfill Total point \arabic{totalpoint}
  \begin{center}
    $\ast\ast\ast$ \textit{End of Examination} $\ast\ast\ast$
    \label{finalpage\Alph{variant}}
  \end{center}
}

% Problem

\newcommand{\problem}[4][1.5]{
 \paragraph{\textnumero\arabic{number}.} \hspace{-1em} {\small\textit{Problem}} \addtocounter{number}{1} \hfill {\small\textit{#3 point}} \addtocounter{totalpoint}{#3} \\[2mm] 
 #2 
 \vspace{2mm} \par \textit{Solution \ldots} 
 \ifthenelse{\equal{\printsolution}{yes}}{#4}{\vspace{#1cm}}
 \vspace{-1em}$$\,$$\textcolor{black!50}{\hrulefill}
}

% Question

\newcommand{\question}[4][0.5]{
 \paragraph{\textnumero\arabic{number}.} \hspace{-1em} {\small\textit{Question}} \addtocounter{number}{1} \hfill {\small\textit{#3 point}} \addtocounter{totalpoint}{#3} \\[2mm] 
 #2 
 \vspace{2mm} \par \textit{Answer \ldots} 
 \ifthenelse{\equal{\printsolution}{yes}}{#4}{\vspace{#1cm}}
 \vspace{-1em}$$\,$$\textcolor{black!50}{\hrulefill}
}

% Test with single or multiple response

\newcounter{testchoices}

\newcommand{\stest}[3]{
 \paragraph{\textnumero\arabic{number}.} \hspace{-1em} {\small\textit{Selective Test}} \addtocounter{number}{1} \hfill {\small\textit{#2 point}} \addtocounter{totalpoint}{#2} \\[2mm] 
 #1 
 \vspace{2mm} \par \textit{\ifthenelse{\equal{\printsolution}{yes}}{Key}{Select} \ldots} \setcounter{testchoices}{1}
 \begin{center}
  \splitlist{#3}
 \end{center}
 \textcolor{black!50}{\hrulefill}
}

\makeatletter
\newcommand{\splitlist}[1]{\@splitlist#1\@nil}
\def\@splitlist#1\@nil{%
  \if\relax\detokenize{#1}\relax
    \expandafter\@gobble
  \else
    \expandafter\@firstofone
  \fi
  {\@spl@tlist#1//\@nil}%
}
\def\@spl@tlist#1//#2\@nil{%
  \ifthenelse{\equal{\printsolution}{yes}}{
    \IfSubStr{#1}{[+]}{\textcircled{\Alph{testchoices}}}{\Alph{testchoices}.}
  }{\Alph{testchoices}.}
  \StrSubstitute[0]{#1}{[+]}{}\qquad \addtocounter{testchoices}{1}
  \if\relax\detokenize{#2}\relax
    \expandafter\@firstoftwo
  \else
    \expandafter\@secondoftwo
  \fi
  {\unskip}%
  {\@spl@tlist#2\@nil}%
}
\makeatother

% Placement Test

\newcommand{\ptest}[2]{
 \paragraph{\textnumero\arabic{number}.} \hspace{-1em} {\small\textit{Placement Test}} \addtocounter{number}{1} \hfill {\small\textit{#2 point}} \addtocounter{totalpoint}{#2} \\[2mm] 
 #1 
 \vspace{0.5em}
 \par\noindent
 \textcolor{black!50}{\hrulefill}
}

\newcommand{\ehide}[1]{\ifthenelse{\equal{\printsolution}{yes}}{#1}{\underline{\phantom{#1}}}}

\newcommand{\thide}[1]{\ifthenelse{\equal{\printsolution}{yes}}{#1}{\uline{#1}}}

\makeatletter
\def\UL@putbox{\ifx\UL@start\@empty \else % not inner
  \vrule\@width\z@ \LA@penalty\@M
  {\UL@skip\wd\UL@box \UL@leaders \kern-\UL@skip}%
    \phantom{\box\UL@box}%
  \fi}
\makeatother

\begin{document}

\print

\end{document}
